@import helper._
@import vn.m2m.common.models.User
@(currentUser:User, userId:String)
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>@Messages("order.title")</title>
    <link rel="icon" type="image/png" href="@routes.Assets.versioned("images/logo.jpg")">
    @*<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />*@
    @*<meta name="viewport" content="width=device-width" />*@
    @views.html.iot.tags.Main_css()
    <link href="@routes.Assets.versioned("stylesheets/landingPage/argon-design-system.css?v=1.2.2")" rel="stylesheet" />
    <link href="@routes.Assets.versioned("stylesheets/views/modal-right.css")" rel="stylesheet" />

    <link href="@routes.Assets.versioned("assets/plugins/notifications/css/lobibox.min.css")" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

    <link href="@routes.Assets.versioned("assets/css/icons.css")" rel="stylesheet">
    <link href='@routes.Assets.versioned("stylesheets/fonts/roboto.css")' type='text/css'>
    <link href="@routes.Assets.versioned("stylesheets/fonts/fonts.googleapis/fontsgoogleapis.css")" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" >
    <link href="@routes.Assets.versioned("assets/plugins/bootstrap-material-datetimepicker/css/bootstrap-material-datetimepicker.min.css")" rel="stylesheet" >

    <link href="@routes.Assets.versioned("stylesheets/views/datatable.css")" rel="stylesheet" />
    <link href="@routes.Assets.versioned("stylesheets/views/telco/order/Order.css")" rel="stylesheet" />
    <link href="@routes.Assets.versioned("stylesheets/views/telco/account/account.css")" rel="stylesheet" />
    <link href="@routes.Assets.versioned("stylesheets/views/telco/telco2.css")" rel="stylesheet" />
    <link href="@routes.Assets.versioned("assets/css/app.css")" rel="stylesheet">

    <link href="@routes.Assets.versioned("stylesheets/views/telco/telco.css")" rel="stylesheet" />
    <link href="@routes.Assets.versioned("stylesheets/views/telco/utilites/utilites.css")" rel="stylesheet" />
  </head>

  <body class="bg-theme">
    @views.html.telco.Menu(currentUser, "", userId)
    @views.html.telco.Header(currentUser)
    <div class="page-wrapper">
      <div class="page-content">
        <div class="accordion" id="accordionSim">
          <div class="row">
            <div class="col-sm-12 col-md-2 utilities-item">

                <div class="accordion-item">
                  <h2 class="accordion-header" id="headingOne">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                      @Messages("order.sim")
                    </button>
                  </h2>
                </div>
                <div class="accordion-item mt-2">
                  <h2 class="accordion-header" id="headingTwo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                      @Messages("order.changeSim")
                    </button>
                  </h2>
                </div>
             
            </div>
            <div class="col-sm-12 col-md-10" style="padding-left: 0px;">
              <div class="utilities-content" style="position: relative">
                <div class="accordion-item">
                  <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionSim">
                    @views.html.telco.buySim.BuySim_oderSim()
                  </div>
                </div>
                
                <div class="accordion-item">
                  <div id="collapseTwo" class="accordion-collapse collapse " aria-labelledby="headingTwo" data-bs-parent="#accordionSim">
                    @views.html.telco.buySim.BuySim_changeSim()
                  </div>
                </div>
               
              </div>
            </div>

          </div>

        </div>
      </div>
      @views.html.telco.buySim.BuySim_chooseSubs_stock()
      @views.html.telco.buySim.BuySim_finish(currentUser)
      @views.html.telco.buySim.BuySim_finish_detail()


      @views.html.telco.Loading()

    </div>
  </body>
  <script type="text/javascript" src="@routes.JsController.jsMessages()"></script>
  <script type="text/javascript" src="@routes.JsController.javascriptRoutes"></script>
  <script src="@routes.Assets.versioned("assets/js/jquery.min.js")" type="text/javascript"></script>

  <script src="@routes.Assets.versioned("javascripts/landingPage/popper.min.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/landingPage/bootstrap.min.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("assets/js/bootstrap.bundle.min.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/landingPage/argon-design-system.js?v=1.2.2")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("assets/plugins/datatable/js/jquery.dataTables.min.js")"></script>

  <script src="@routes.Assets.versioned("assets/plugins/bootstrap-material-datetimepicker/js/moment.min.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/bootstrap-material-datetimepicker/js/bootstrap-material-datetimepicker.min.js")"></script>

  <script src="@routes.Assets.versioned("assets/plugins/notifications/js/lobibox.min.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/notifications/js/notifications.min.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/notifications/js/notification-custom-script.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/ShowNotification.js")" type="text/javascript"></script>

  <script src="@routes.Assets.versioned("javascripts/importExcel/xlsx.full.min.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/importExcel/jszip.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/exportfile/table3export.js")" type="text/javascript"></script>

  <script src="@routes.Assets.versioned("javascripts/views/telco/buySim/ValidateBuySim.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/buySim/BuySim.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/buySim/BuySim_packData.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/buySim/BuySim_chooseSubs.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/buySim/BuySim_comfirm.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/buySim/ChangeSim.js")" type="text/javascript"></script>
  
  <script src="@routes.Assets.versioned("javascripts/views/telco/utilities/miAddOn.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/utilities/blockSubs.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/utilities/export.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/telco/validateForm.js")" type="text/javascript"></script>
  @views.html.BackToTop()

  <script type="text/javascript">
      var userId = '@userId';

      $(document).ready(function () {
          $('#filesMiAddOnSubs').on('change', uploadMiAddonSubs);
      });

      function importFileMiAddOnSubs() {
          $("#filesMiAddOnSubs").click();
      }

      // ------------------------ STEP HANDLE ------------------------

      function findStepContainer(groupID) {
          const $container = $(`.step-container[data-group-id="${groupID}"]`);
          if (!$container.length) {
              console.error('@Messages("buySim.error.stepContainerNotFound"):', groupID);
              return null;
          }
          return $container;
      }

      function changeStep(groupID, direction = 'next') {
          const $container = findStepContainer(groupID);
          if (!$container) return;

          const $currentStep = $container.find('.step.active');
          const $targetStep = direction === 'next' 
              ? $currentStep.nextAll('.step').first()
              : $currentStep.prevAll('.step').first();

          if (!$targetStep.length) return;

          $currentStep.removeClass('active');
          $targetStep.addClass('active');
      }

      function nextStep(groupID) {
          changeStep(groupID, 'next');
      }

      function backStep(groupID) {
          changeStep(groupID, 'prev');
      }

      // ------------------------ PROCESS HANDLER ------------------------

      function nextProcess(btn, groupID) {
          const $btn = $(btn);
          if ($btn.prop("disabled")) return;

          $btn.prop("disabled", true);
          let stepValue = parseInt(btn.value);
          let isValid = true;

          switch (stepValue) {
              case 1:
                  isValid = groupID === "orderSim" ? validateFormInfoDNOrderSim() : validateFormInfoDNChangeSim();
                  break;

              case 2:
                  if (groupID === "orderSim") {
                      isValid = validateFormChoosePack();
                      if (isValid) checkOrderInformation();
                  } else {
                      checkChangeInformation();
                  }
                  break;

              case 3:
                  groupID === "orderSim" ? confirmOder() : confirmChangeSim();
                  break;
          }

          if (!isValid) {
              $btn.prop("disabled", false);
              return;
          }

          const $currentStepContent = $btn.closest(".step-content");
          const $nextStepContent = $currentStepContent.next(".step-content");

          if (!$nextStepContent.length) return;

          $currentStepContent.fadeOut("slow", function () {
              $nextStepContent.fadeIn("slow", function () {
                  $btn.prop("disabled", false);
              });
          });

          nextStep(groupID);
      }

      function backProcess(btn, groupID) {
          const $btn = $(btn);
          if ($btn.prop("disabled")) return;

          $btn.prop("disabled", true);

          const $currentStepContent = $btn.closest(".step-content");
          const $prevStepContent = $currentStepContent.prev(".step-content");

          $currentStepContent.fadeOut("slow", function () {
              $prevStepContent.fadeIn("slow", function () { 
                  $btn.prop("disabled", false);
              });
          });

          backStep(groupID);
      }

  </script>

</html>