@import helper._
@import vn.m2m.utils.DateUtil
@import vn.m2m.common.models.User
@import vn.m2m.utils.UserHelper
@(currentUser:User, projectId:String, idDashboard:String)

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>@Messages("Dashboard")</title>
    <link rel="icon" type="image/png" href="@routes.Assets.versioned("images/logo.jpg")">

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />

    @views.html.iot.tags.Main_css()

    <link href="@routes.Assets.versioned("assets/plugins/highcharts/css/highcharts-white.css")" rel="stylesheet" />
    <script type="text/javascript" src="@UserHelper.linkGoogleMapApi"> </script>
    <link href='@routes.Assets.versioned("stylesheets/fonts/roboto.css")' type='text/css'>
    @*<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" >*@
    <link href="@routes.Assets.versioned("assets/plugins/bootstrap-material-datetimepicker/css/bootstrap-material-datetimepicker.min.css")" rel="stylesheet" >

    <link href="@routes.Assets.versioned("stylesheets/views/dashboard/ver2/dashboard.css")" rel="stylesheet"/>
    <link href="@routes.Assets.versioned("javascripts/views/dashboard/widget/gridstack.min.css")" rel="stylesheet"/>
    @*<link href="@routes.Assets.versioned("stylesheets/views/dashboard/widget/round-switch.css")" rel="stylesheet"/>*@
    <link href="@routes.Assets.versioned("stylesheets/views/dashboard/widget/switchSocket.css")" rel="stylesheet"/>
    <link href="@routes.Assets.versioned("stylesheets/views/dashboard/widget/command.css")" rel="stylesheet"/>

    <link rel='stylesheet' href='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css'/>
    <link rel='stylesheet' href="@routes.Assets.versioned("javascripts/plugins/openStreetMap/MarkerCluster.Default.css")"/>
    <link rel='stylesheet' href="@routes.Assets.versioned("javascripts/plugins/openStreetMap/MarkerCluster.css")"/>

  </head>
  <body class="bg-theme">

    <div class="">
      @views.html.iot.tags.Menu(currentUser, projectId)

      @views.html.iot.tags.Header(currentUser)

      <div class="page-wrapper">
        <div class="grid-stack" data-gs-width="12" style="background-color: #eceff1" id="bodyDashboard">
        </div>
      </div>

    </div>

    <div class="">
      <div class="toolbar" style="float: right; transition: 0.4s;position: fixed;bottom: 10px;right: 20px;z-index: 99;">
        @*<button class="btn btn-secondary px-3 radius-30" onclick="backListDashboard()">*@
          @*<i class="bx bx-chevron-left" aria-hidden="true"></i> @Messages("widget.back")*@
        @*</button>*@
        <button class="btn btn-light px-3 radius-30" onclick="routesPageWiget()" style="color: black;">
          <i class="bx bx-edit" aria-hidden="true"></i> @Messages("widget.edit")
        </button>
      </div>
    </div>

    <div class="switcher-wrapper">
      <div class="switcher-btn"> <i class='bx bx-cog bx-spin'></i>
      </div>
      <div class="switcher-body">
        <div class="d-flex align-items-center">
          <h5 class="mb-0 text-uppercase text-danger">@Messages("Cấu hình")</h5>
          <button type="button" class="btn-close ms-auto close-switcher" aria-label="Close"></button>
        </div>
        <hr/>

        @fromTime = @{
          import java.util.Calendar
          import java.text.SimpleDateFormat

          val today = Calendar.getInstance
          today.add(Calendar.DATE,-1);
          val curTimeFormat = new SimpleDateFormat("dd/MM/yyyy HH:mm")
          curTimeFormat.format(today.getTime)
        }
        @toTime = @{
          import java.util.Calendar
          import java.text.SimpleDateFormat
          //import java.util.TimeZone

          val today = Calendar.getInstance()
          // today.setTimeZone(TimeZone.getTimeZone("GMT+7"))
          val curTimeFormat = new SimpleDateFormat("dd/MM/yyyy HH:mm")
          curTimeFormat.setTimeZone(TimeZone.getTimeZone("GMT+7"));
          curTimeFormat.format(today.getTime)
        }

        <div class="row">
          <div class="form-group mt-3">
            <div class="row">
              <label class="col-md-3 col-form-label" style="text-align: center">@Messages("Từ ")</label>
              <div class="col-md-9">
                <div class="form-group">
                  <input class="result form-control" type="text" id="date_timepicker_start" value="@fromTime">
                </div>
              </div>
            </div>
          </div>

          <div class="form-group mt-3">
            <div class="row">
              <label class="col-md-3 col-form-label" style="text-align: center">@Messages("Đến ")</label>
              <div class="col-md-9">
                <div class="form-group has-default">
                  <input class="result form-control" type="text" id="date_timepicker_end" value="@toTime">
                </div>
              </div>
            </div>
          </div>

          <div class="form-group mt-3">
            <div class="row">
              <label class="col-md-3 col-form-label" style="text-align: center">@Messages("Type")</label>
              <div class="col-md-9">
                <div class="form-group has-default">
                  <select class="form-control" id="aggType" onchange="chooseAggType(this)">
                    <option value="NONE" selected>@Messages("NONE")</option>
                    <option value="MAX">@Messages("MAX")</option>
                    <option value="MIN">@Messages("MIN")</option>
                    <option value="AVG">@Messages("AVG")</option>
                      <option value="SUM">@Messages("SUM")</option>
                      <option value="COUNT">@Messages("COUNT")</option>
                  </select>
                </div>
              </div>
            </div>
          </div>

          <div class="form-group mt-3" style="display: none" id="tabInterval">
            <div class="row">
              <label class="col-md-3 col-form-label" style="text-align: center">@Messages("Interval")</label>
              <div class="col-md-9">
                <div class="form-group has-default">
                  <input class="result form-control" type="number" id="interval" value="0">
                </div>
              </div>
            </div>
          </div>

          <div class="btn-group mt-3">
            <a type="button" class="btn btn-danger" onclick="applyConfigDashboard()" style="width: 48%">@Messages("Áp dụng ")</a>
            <a type="button" class="btn btn-telco" onclick="resetConfigDashboard()" style="width: 48%; border: 1px solid red;">@Messages("Reset ")</a>
          </div>
        </div>

      </div>
    </div>

    @views.html.Loading()
  </body>

  @views.html.iot.tags.Main_js()

  <script>
    var projectId = '@projectId';
    var idDashboard = '@idDashboard';
    var linkMapbox = '@UserHelper.linkGoogleMapbox';

          $(document).ready(function () {
            $("#menu-dashboard").addClass("mm-active");
            $("#menu").metisMenu();

            $('#date_timepicker_start').bootstrapMaterialDatePicker({
              format: 'DD/MM/YYYY HH:mm',
//                time: false
            });
            $('#date_timepicker_end').bootstrapMaterialDatePicker({
              format: 'DD/MM/YYYY HH:mm',
//                time: false
            });
          });

    function routesPageWiget() {
      window.location.href = jsRoutes.controllers.WidgetListController.widgetPage('@projectId', '@idDashboard').url;
    }

    function backListDashboard() {
      window.location.href = jsRoutes.controllers.DashboardV3Controller.dashboardList('@projectId').url;
    }
  </script>

  <script>
          var device_vtag = "@routes.Assets.versioned("images/dashboard/marker.png")";

          var circleSignal_run = "@routes.Assets.versioned("images/signal/greenCircle.gif")";
          var circleSignal_parking = "@routes.Assets.versioned("images/signal/blueCircle.gif")";
          var circleSignal_lost_Gps = "@routes.Assets.versioned("images/signal/yellowCircle.gif")";
          var circleSignal_lost_connect = "@routes.Assets.versioned("images/signal/grayCircle.gif")";
          var circleSignal_alarm = "@routes.Assets.versioned("images/signal/redCircle.gif")";

  </script>
  <script src="@routes.Assets.versioned("assets/plugins/apexcharts-bundle/js/apexcharts.min.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/plugins/loader.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/chartist/chartist.min.js")"></script>

  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/highcharts.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/highcharts-more.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/variable-pie.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/solid-gauge.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/highcharts-3d.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/cylinder.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/funnel3d.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/exporting.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/export-data.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/highcharts/js/accessibility.js")"></script>
  <script src="@routes.Assets.versioned("assets/plugins/mustache/js/mustache.min.js")"></script>

  <script src="@routes.Assets.versioned("assets/plugins/bootstrap-material-datetimepicker/js/bootstrap-material-datetimepicker.min.js")"></script>

  <script src="@routes.Assets.versioned("javascripts/views/dashboard/widget/gridstack-h5.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/MapPositionMarkerCluster.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_map.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/Dashboard_map_markerSignal.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/Dashboard_map_markerCluster.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/Dashboard_map_infoWindow.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/Dashboard_map_updateMarker.js")"></script>

  <script type="text/javascript" src="@routes.Assets.versioned("javascripts/plugins/openStreetMap/leaflet.js")"></script>
  <script type="text/javascript" src="@routes.Assets.versioned("javascripts/plugins/openStreetMap/leaflet.markercluster-src.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_map_mapbox.js")"></script>

  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_chart.js")"></script>
  <script id="dashboard-widget-table-template" type="x-tmpl-mustache">
    <table class="table table-striped">
        <thead class="thead-light">
            <tr>
                <th scope="col">Thiết bị</th>
                <th scope="col">Thuộc tính</th>
                <th scope="col">Dữ liệu</th>
                <th scope="col">Thời gian</th>
            </tr>

        </thead>
        <tbody>
            {{#.}}
              <tr>
                    <th scope="row">{{device}}</th>
                    <td>{{var}}</td>
                    <td>{{data}}</td>
                    <td>{{time}}</td>
              </tr>
            {{/.}}
        </tbody>
    </table>
  </script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_table.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_gauge.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_round_switch.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_data.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_command.js")"></script>
  <script src="@routes.Assets.versioned("javascripts/views/dashboard/ver2/dashboard_config.js")"></script>

</html>
