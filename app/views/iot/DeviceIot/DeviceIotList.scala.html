@import helper._
@import vn.m2m.utils.DateUtil
@import vn.m2m.common.models.User
@import vn.m2m.iot.models.DeviceIot
@import vn.m2m.utils.UserHelper
@import vn.m2m.common.models.forms.SearchObjectData
@(currentUser:User, deviceIotList: List[DeviceIot], projectId:String)
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <title>@Messages("Manage Devices")</title>
        <link rel="icon" type="image/png" href="@routes.Assets.versioned("images/logo.jpg")">

        <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
        <meta name="viewport" content="width=device-width" />

        @views.html.iot.tags.Main_css()

        <link href="@routes.Assets.versioned("stylesheets/views/group/style.min.css")" rel="stylesheet" />
        <link href="@routes.Assets.versioned("stylesheets/views/modal-right.css")" rel="stylesheet" />

        <link href="@routes.Assets.versioned("assets/plugins/smart-wizard/css/smart_wizard_all.min.css")" rel="stylesheet" type="text/css" />

        <style>
            .deviceID {
                cursor: pointer;
            }
            .deviceID:hover {
                color: #00a5bb;
            }
        </style>

    </head>
    <body class="bg-theme">
        @views.html.iot.tags.Menu(currentUser, projectId)

        @views.html.iot.tags.Header(currentUser)

        <div class="page-wrapper">
            <div class="page-content">

                    <!--breadcrumb-->
                <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3 ">
                    <div class="breadcrumb-title pe-3">@Messages("manage.manage")</div>
                    <div class="ps-3">
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb mb-0 p-0">
                                <li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt "></i></a>
                                </li>
                                <li class="breadcrumb-item active " aria-current="page">@Messages("manage.group.device")</li>
                            </ol>
                        </nav>
                    </div>
                    <div class="ms-auto">

                    </div>
                </div>
                    <!--end breadcrumb-->

                <div class="card ">
                    <div class="card-header card-header-primary card-header-icon">
                        <div class="toolbar" style="float: right">
                            <button class="btn btn-light px-5 radius-30" onclick="getAddListOrganization()" data-bs-toggle="modal" data-bs-target="#addConfirmModal">
                                <i class="bx bx-plus" aria-hidden="true"></i> @Messages("device.addNew")
                            </button>
                        </div>
                    </div>

                    <div class="card-body">
                        <div class="table-responsive">

                            <table id="dataTables" class="table table-striped table-bordered">
                                <thead class="cf">
                                    <th data-field="id">@Messages("ID")</th>
                                    <th data-field="name">@Messages("filter.name")</th>
                                    @*<th data-field="groupID">@Messages("filter.groupID")</th>*@
                                    <th data-field="organization">@Messages("filter.organizationName")</th>
                                    <th data-field="groupName">@Messages("filter.groupName")</th>
                                    <th data-field="type">@Messages("filter.typeName")</th>
@*                                    <th data-field="type">@Messages("filter.connect")</th>*@
                                    <th data-field="type">@Messages("filter.message")</th>
                                    <th>@Messages("btnAction")</th>

                                </thead>
                                <tbody align="left">
                                @for((device: DeviceIot)<- deviceIotList) {
                                    <tr>
                                        <td>
                                            <a class="deviceID" href="@routes.DeviceVariableController.deviceVariable(projectId, device.getId())" target="_blank"  data-bs-toggle="tooltip" data-bs-placement="bottom" title="@Messages("device.variable.manage")">@device.getId</a>
                                        </td>
                                        <td>@device.getName</td>
                                        @*<td>@device.getGroupId</td>*@
                                        <td>@device.getOrgName</td>
                                        <td>@device.getGroupName</td>
                                        <td>@device.getTypeName</td>
@*                                        <td>*@
@*                                            @if(device.isStatus){*@
@*                                                <a rel="tooltip" title="@Messages("device.connectSuccess")" class="btn btn-success">*@
@*                                                    <i class="bx bx-message-square-check me-0"></i>*@
@*                                                </a>*@
@*                                            } else {*@
@*                                                <a rel="tooltip" title="@Messages("device.connectFalse")" class="btn btn-dark" onclick="getTokenUserAndDevice('@device.getId', '@currentUser.getDeviceToken')" data-bs-toggle="modal" data-bs-target="#connectDeviceModal">*@
@*                                                    <i class="bx bx-message-square-error me-0"></i>*@
@*                                                </a>*@
@*                                            }*@
@*                                        </td>*@
                                        <td>
                                            <a rel="tooltip" title="@Messages("btnSms")" class="btn btn-light" href="@routes.MessagesDeviceController.messagesDevice(device.getId)" target="_blank">
                                                <i class="bx bx-envelope me-0"></i>
                                            </a>
                                        </td>
                                        <td class="dt-buttons btn-group" style="width: 90%">
                                            <button rel="tooltip" title="@Messages("btnUpdate")" class="btn btn-light btn-success" onclick="getDataUpdateDevice('@device.getId','@device.getGroupId','@device.getOrgID','@device.getTypeID')" data-bs-toggle="modal" data-bs-target="#updateConfirmModal" type="button">
                                                <i class="bx bx-refresh me-0"></i>
                                            </button>
                                            <button rel="tooltip" title="@Messages("btnEdit")" class="btn btn-light" onclick="editDeviceName('@device.getId', '@device.getName')" data-bs-toggle="modal" data-bs-target="#editConfirmModal" type="button">
                                                <i class="bx bx-edit me-0"></i>
                                            </button>
                                            <button rel="tooltip" title="@Messages("btnDelete")" class="btn btn-light" onclick="deleteDeviceId('@device.getId')" data-bs-toggle="modal" data-bs-target="#deleteDeviceconfirm" type="button">
                                                <i class="bx bx-x me-0"></i>
                                            </button>
                                        </td>

                                    </tr>
                                }
                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>
            </div>

            @views.html.iot.DeviceIot.DeviceIotList_add()
            @views.html.iot.DeviceIot.DeviceIotList_del()
            @views.html.iot.DeviceIot.DeviceIotList_edit()
            @views.html.iot.DeviceIot.DeviceIotList_update()

@*            @views.html.iot.DeviceIot.DeviceIotList_connect()*@

            @views.html.Loading()

        </div>
            <!--  END OF PAPER WRAP -->

        @views.html.iot.tags.Main_js()

        <script src="@routes.Assets.versioned("assets/js/bootstrap.bundle.min.js")"></script>
            <!--plugins-->
        <script src="@routes.Assets.versioned("assets/plugins/simplebar/js/simplebar.min.js")"></script>
        <script src="@routes.Assets.versioned("assets/plugins/metismenu/js/metisMenu.min.js")"></script>
        <script src="@routes.Assets.versioned("assets/plugins/perfect-scrollbar/js/perfect-scrollbar.js")"></script>
        <script>
                $(document).ready(function () {
                    $("#menu-device").addClass("mm-active");
                    $("#menu").metisMenu();
                })
        </script>

        <script src="@routes.Assets.versioned("javascripts/SearchJs.js")" type="text/javascript"></script>

        <script>
            $(document).ready(function() {
                getListOrganizations();
                getListGroups();
                getListTypes();

                var table = $('#dataTables').DataTable( {
                    lengthChange: false,
//                    buttons: [ 'excel', 'pdf', 'print'],
                    "order": [],
                    "info": false
                } );
                $("#dataTables_filter input")[0].maxLength = 30;

//                table.buttons().container()
//                        .appendTo( '#dataTables_wrapper .col-md-6:eq(0)' );
            } );
        </script>

        <script src="@routes.Assets.versioned("javascripts/views/group/jstree.js")" type="text/javascript"></script>
        <script src="@routes.Assets.versioned("javascripts/views/device/DeviceIot.js")"></script>
        <script src="@routes.Assets.versioned("javascripts/views/device/DeviceIot_add.js")"></script>

        <script src="@routes.Assets.versioned("assets/plugins/smart-wizard/js/jquery.smartWizard.min.js")"></script>
        <script src="@routes.Assets.versioned("javascripts/views/device/DeviceIot_description.js")"></script>
        <script>
                $(document).ready(function () {
                    // Toolbar extra buttons
                    var btnFinish = $('<button></button>').text('Finish').addClass('btn btn-info').on('click', function () {
                        alert('Finish Clicked');
                    });
                    var btnCancel = $('<button href="#" data-bs-dismiss="modal"></button>').text('Cancel').addClass('btn btn-danger').on('click', function () {
                        resetFormWizard();
                    });
                    // Step show event
                    $("#smartwizard").on("showStep", function (e, anchorObject, stepNumber, stepDirection, stepPosition) {
                        $("#prev-btn").removeClass('disabled');
                        $("#next-btn").removeClass('disabled');
                        if (stepPosition === 'first') {
                            $("#prev-btn").addClass('disabled');
                        } else if (stepPosition === 'last') {
                            $("#next-btn").addClass('disabled');
                        } else {
                            $("#prev-btn").removeClass('disabled');
                            $("#next-btn").removeClass('disabled');
                        }
                    });
                    // Smart Wizard
                    $('#smartwizard').smartWizard({
                        selected: 0,
                        theme: 'arrows',
                        transition: {
                            animation: 'slide-horizontal', // Effect on navigation, none/fade/slide-horizontal/slide-vertical/slide-swing
                        },
                        toolbarSettings: {
//                            toolbarPosition: 'both', // both bottom
                            toolbarExtraButtons: [btnCancel]
                        }
                    });
                    // External Button Events
                    $("#reset-btn").on("click", function () {
                        // Reset wizard
                        $('#smartwizard').smartWizard("reset");
                        return true;
                    });
                    $("#prev-btn").on("click", function () {
                        // Navigate previous
                        $('#smartwizard').smartWizard("prev");
                        return true;
                    });
                    $("#next-btn").on("click", function () {
                        // Navigate next
                        $('#smartwizard').smartWizard("next");
                        return true;
                    });

                });

                function resetFormWizard() {
                    $('#smartwizard').smartWizard("reset");
                }
        </script>
    </body>
</html>
