@import vn.m2m.common.models.User
@import vn.m2m.utils.UserHelper
@(currentUser:User, projectId:String)
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>@Messages("History Map")</title>
    <link rel="icon" type="image/png" href="@routes.Assets.versioned("images/logo.jpg")">

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />

    <link href="@routes.Assets.versioned("stylesheets/views/solution/tracking/history.css")" rel="stylesheet"/>

    @views.html.iot.tags.Main_css()
    <script type="text/javascript" src="@UserHelper.linkGoogleMapApi"></script>
    <link href="@routes.Assets.versioned("stylesheets/views/solution/tracking/datetimepicker.css")" rel="stylesheet"/>

    <link href="@routes.Assets.versioned("javascripts/plugins/select2/css/select2.min.css")" rel="stylesheet" />
    <link href="@routes.Assets.versioned("javascripts/plugins/select2/css/select2-bootstrap4.css")" rel="stylesheet" />


    <style type="text/css">
            .move-in {
              -moz-transition: all 0.4s ease;
              -webkit-transition: all 0.4s ease;
              -o-transition: all 0.4s ease;
              -ms-transition: all 0.4s ease;
              transition: all 0.4s ease;
              position: absolute;
              top: 45%;
              left: 97%;
              width: 28px;
              height: 55px;
              display: block;
              padding: 10px 10px 10px 0px;
              z-index: 96;
              cursor: pointer;
              margin-left: -4px;
              background: url(@routes.Assets.versioned("img/sidebar/moveicon-in.png")) no-repeat;
            }

            .move-out {
              -moz-transition: all 0.4s ease;
              -webkit-transition: all 0.4s ease;
              -o-transition: all 0.4s ease;
              -ms-transition: all 0.4s ease;
              transition: all 0.4s ease;
              position: absolute;
              top: 45%;
              left: 0px;
              width: 28px;
              height: 55px;
              display: block;
              padding: 10px 10px 10px 0px;
              z-index: 96;
              cursor: pointer;
              background: url(@routes.Assets.versioned("img/sidebar/moveicon-out.png")) no-repeat;
            }
    </style>

  </head>
  <body class="bg-theme" style="overflow: hidden;">
    <div class="wrapper">
      @views.html.iot.tags.Menu(currentUser, projectId)

      @views.html.iot.tags.Header(currentUser)


      <div class="page-wrapper">
        <div class="page-content" style="padding: 0px;">
          <div class="main-panel">
            <div class="overlay-map">

              <div id="sidebar-wrapper" class="left-panel">
                <div class="sidebar-content">
                  <div class="panel-heading ">
                    <h4 class="panel-title align-items-center text-white" style="margin-bottom: 0;">@Messages("manage.tracking.history.title")</h4>
                  </div>
                  <div class="panel-body">

                    @fromTime = @{
                      import java.text.SimpleDateFormat
                      import java.util.Calendar

                      val today = Calendar.getInstance
                      today.add(Calendar.DATE, +0);
                      val curTimeFormat = new SimpleDateFormat("dd/MM/yyyy")
                      curTimeFormat.format(today.getTime)
                    }

                    @toTime = @{
                      import java.text.SimpleDateFormat
                      import java.util.Calendar
                      import java.util.TimeZone

                      val today = Calendar.getInstance()
                      val curTimeFormat = new SimpleDateFormat("dd/MM/yyyy HH:mm")
                      curTimeFormat.setTimeZone(TimeZone.getTimeZone("GMT+7"))
                      curTimeFormat.format(today.getTime)
                    }

                    <div class="col-md-12" style="padding: 3px 3px 3px 10px;">
                      <div class="search-field">
                        <div class="row">
                          <label for="date_timepicker_start" class="col-sm-3 col-form-label form-group"> @Messages("manage.tracking.history.start") </label>
                          <div class="col-sm-8">
                            <input id="date_timepicker_start" class="result form-control datetimepicker" type="text" value="@fromTime 00:00" autocomplete="off" style=""/>
                          </div>
                        </div>
                      </div>
                      <div class="search-field mt-2">
                        <div class="row">
                          <label for="date_timepicker_end" class="col-sm-3 col-form-label form-group">@Messages("manage.tracking.history.end")</label>
                          <div class="col-sm-8">
                            <input id="date_timepicker_end" class="result form-control datetimepicker" type="text" value="@toTime" autocomplete="off" style="">
                          </div>
                        </div>
                      </div>
                      <div class="search-field mt-2">
                        <div class="row">
                          <label class="col-sm-3 col-form-label">@Messages("manage.tracking.map.name")</label>
                          <div class="col-sm-8" id="selectDevice">
                            <select id="idDevice" data-placeholder="" class="single-select" style="width: 100%">
                              <option value="">@Messages("manage.tracking.history.chooseDevice")</option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div >

                    <div class="col-md-12 text-right" style="padding: 5px 0px">
                      <div class="row">
                        <div class="col-md-12">
                          <button style="float: left;width: 45%; height: 35px; background-color: #de2436bf; color: white; margin-left: 5px;" type="button" class="btn btnControlHistory" onclick="processGetListHistory()">
                            <i class="bx bx-search-alt" style="margin-bottom: -1rem;"></i>@Messages("manage.tracking.history.view")
                          </button>
                          <button style="float: left;width: 45%; height: 35px; background-color: #de2436bf; color: white; margin-left: 5px;" type="button" id="buttonPlayStop" class="btn btnControlHistory" onclick="playbackHistory()">
                            <i class="bx bx-play-circle" style="margin-bottom: -1rem;"></i> @Messages("manage.tracking.history.play")
                          </button>
                          <select type="button" class="btn" style="float: left;width: 45%; height: 35px;margin-left: 5px;background-color: #de2436bf; color: white;margin-top: 5px;" id="searchQuickHistory" onchange="searchQuickHistory()" title="@Messages("manage.tracking.history.quick")">
                            <option value="">@Messages("manage.tracking.history.quick")</option>
                            <option value="1">@Messages("history.search1Day")</option>
                            <option value="3">@Messages("history.search3Day")</option>
                            <option value="7">@Messages("history.search7Day")</option>
                            <option value="15">@Messages("history.search15Day")</option>
                            <option value="30">@Messages("history.search30Day")</option>
                          </select>
                          <select type="button" class="btn" style="float: left;width: 45%; height: 35px;margin-left: 5px; margin-top: 5px;background-color: #de2436bf; color: white" id="changeSpeedPlay" onchange="changeSpeedPlay()">
                            <option value="0.5">@Messages("Tốc độ 0.5")</option>
                            <option value="1" selected>@Messages("Tốc độ 1.0")</option>
                            <option value="2">@Messages("Tốc độ 2.0")</option>
                            <option value="5">@Messages("Tốc độ 5.0")</option>
                          </select>
                        </div>
                      </div>
                    </div>

                    <div id="scroll-area-position" class="col-md-12" style="padding: 0; margin-top: 15px;float: left;">
                      <div class="table-responsive">
                        <table class="table mb-0" id="table-map-view" style="background-color: #EAEBEB">
                          <thead id="theadExport" style="color: white; background-color: #858687">
                            <tr>
                              <th class="text-center" style="width: 40px">@Messages("STT")</th>
                              <th style="width: 100px">@Messages("Vị trí ")</th>
                              <th style="width: 100px">@Messages("Thời gian")</th>
                            </tr>
                          </thead>
                          <tbody>

                          </tbody>
                        </table>
                      </div>
                    </div>

                    <div class="col-md-12" style="float: left; padding: 5px; background-color: #dee2e6;">
                      <table style="margin-bottom: 0">
                        <thead>
                          <tr>
                            <th style="width: 80px"></th>
                            <th>@Messages("Tổng")@Messages(" ")</th>
                            <th id="id-sum-stt" style="padding-right: 5px; text-align: right !important;">0</th>
                          </tr>
                        </thead>
                      </table>
                    </div>

                  </div>
                </div>
              </div>

              <a id="menu-toggle" class="move-in"></a>

            </div>
          </div>

          <div id="page-content-wrapper">
            <div id = "map-canvas" class="big-map" style="position: absolute"></div>
          </div>

        </div>
      </div>

    </div>

    @views.html.Loading()
  </body>

  <script src="@routes.Assets.versioned("javascripts/jquery/jquery.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/jquery/jquery-ui.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/jquery/jquery-ui.min.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/jquery/jquery-ui-1.12.1.js")" type="text/javascript"></script>

  @views.html.iot.tags.Main_js()

  <script src="@routes.Assets.versioned("javascripts/jquery/jquery-1.12.4.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/plugins/select2/js/select2.min.js")" type="text/javascript"></script>

  <script src="@routes.Assets.versioned("javascripts/bootstrap/bootstrap-datetimepicker.min.js")" type="text/javascript"></script>

  <script>
          var projectId = '@projectId';

          $(document).ready(function () {
            $("#menu-tracking").addClass("mm-active");
            $("#menu-tracking-history").addClass("mm-active");
            $("#menu").metisMenu();

            $('.single-select').select2({
              theme: 'bootstrap4',
              width: $(this).data('width') ? $(this).data('width') : $(this).hasClass('w-100') ? '100%' : 'style',
              placeholder: $(this).data('placeholder'),
              allowClear: Boolean($(this).data('allow-clear'))
            });

            $('.datetimepicker').datetimepicker({
              format:"DD/MM/YYYY HH:mm",
              sideBySide:true,
              icons: {
                time: "fa fa-clock-o",
                date: "fa fa-calendar",
                up: "fa fa-chevron-up",
                down: "fa fa-chevron-down",
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-remove',
              },
            });
          });
  </script>

  <script>
          var initLatLng = new google.maps.LatLng(15.664142, 104.266281);
          var mapOptions = {
            center: initLatLng,
            zoom: 6,
            zoomControl: true,
            zoomControlOptions: {
              position: google.maps.ControlPosition.TOP_RIGHT
            },
            mapTypeControlOptions: {
              position: google.maps.ControlPosition.BOTTOM_CENTER
            },
            mapTypeControl: false,
            scaleControl: false,
            streetViewControl: false,
            fullscreenControl: true,
            fullscreenControlOptions: {
              position: google.maps.ControlPosition.RIGHT_BOTTOM
            },
            gestureHandling: 'greedy'
          };
          var mapHistory = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

          $('.nav-overlay>nav').attr("style", "background-color: rgba(0,0,0,0.5) !important; color: white; position: relative !important;");
          $('#map-canvas').attr("style", "position: absolute;");

          var slideMarkerList = [];
          var markerSlide;
          var delay_playback_max = 2500;
          var delay_playback_min = 250;
          var delay_playback = 2500;
          var effect_playback="linear";
          var drawPlayBackFlag =false;

          var startRacing = "@routes.Assets.versioned("img/history/startIcon.png")";
          var destRacing = "@routes.Assets.versioned("img/history/endIcon.png")";
          var point = "@routes.Assets.versioned("images/vtag/location1.png")";


  </script>
  <script src="@routes.Assets.versioned("javascripts/views/solution/tracking/monitorMap/TrackingUtil.js")" type="text/javascript"></script>

  <script src="@routes.Assets.versioned("javascripts/views/solution/tracking/history/jquery.easing.1.3.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/solution/tracking/history/markerAnimate.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/solution/tracking/history/SlidingMarker.js")" type="text/javascript"></script>

  <script src="@routes.Assets.versioned("javascripts/views/solution/tracking/history/HistoryMap.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/solution/tracking/history/HistoryMap-Marker.js")" type="text/javascript"></script>
  <script src="@routes.Assets.versioned("javascripts/views/solution/tracking/history/HistoryMap-Polyline.js")" type="text/javascript"></script>

</html>