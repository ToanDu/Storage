@import helper._
@import vn.m2m.utils.DateUtil
@import vn.m2m.common.models.User
@import vn.m2m.iot.models.DeviceIot
@import vn.m2m.iot.models.Event
@import vn.m2m.utils.UserHelper
@import vn.m2m.common.models.forms.SearchObjectData
@import vn.m2m.iot.models.Organization
@(currentUser:User, deviceList: List[DeviceIot], eventList: List[Event], organizationList: List[Organization])
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
        <title>@Messages("Manage Events")</title>
        <link rel="icon" type="image/png" href="@routes.Assets.versioned("images/logo.jpg")">

        <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
        <meta name="viewport" content="width=device-width" />

        @views.html.iot.tags.Main_css()

        <link href="@routes.Assets.versioned("stylesheets/views/group/style.min.css")" rel="stylesheet" />
        <link href="@routes.Assets.versioned("stylesheets/views/events/events.css")" rel="stylesheet" />
        <link href="@routes.Assets.versioned("stylesheets/views/modal-right.css")" rel="stylesheet" />

    </head>
    <body class="bg-theme">
        @views.html.iot.tags.Menu(currentUser, "")

        @views.html.iot.tags.Header(currentUser)

        <div class="page-wrapper">
            <div class="page-content">

                    <!--breadcrumb-->
                <div class="page-breadcrumb d-none d-sm-flex align-items-center mb-3 ">
                    <div class="breadcrumb-title pe-3">@Messages("manage.manage")</div>
                    <div class="ps-3">
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb mb-0 p-0">
                                <li class="breadcrumb-item"><a href="javascript:;"><i class="bx bx-home-alt "></i></a>
                                </li>
                                <li class="breadcrumb-item active " aria-current="page">@Messages("manage.group.event")</li>
                            </ol>
                        </nav>
                    </div>
                    <div class="ms-auto">

                    </div>
                </div>
                    <!--end breadcrumb-->

                <div class="card " >
                    <div class="card-header card-header-primary card-header-icon">
                        <div class="toolbar" style="float: right">
                            <button class="btn btn-light px-5 radius-30" data-bs-toggle="modal" data-bs-target="#addConfirmModal">
                                <i class="bx bx-plus" aria-hidden="true"></i> @Messages("event.title.addNewEvent")
                            </button>
                        </div>
                    </div>

                    <div class="card-body">
                        <div class="table-responsive">

                            <table id="dataTables" class="table table-striped table-bordered">
                                <thead class="cf">
                                    <th data-field="id">@Messages("ID")</th>
                                    <th data-field="name">@Messages("event.title.name")</th>
                                    <th data-field="group">@Messages("event.column.title.organization")</th>
                                    <th data-field="group">@Messages("event.column.title.status")</th>
                                    <th>@Messages("btnAction")</th>

                                </thead>
                                <tbody align="left">
                                @for((event: Event)<- eventList) {
                                    <tr>
                                        <td>@event.getId</td>
                                        <td>@event.getName</td>
                                        <td>@event.getOrganization</td>
                                        <td>@event.getStatusStr</td>
                                        <td class="dt-buttons btn-group" style="width: 90%">
                                            <button rel="tooltip" title="@Messages("btnEdit")" class="btn btn-light" onclick="getEvent('@event.getId')" data-bs-toggle="modal" data-bs-target="#editEventModal">
                                                <i class="bx bx-edit me-0"></i>
                                            </button>
                                            <button rel="tooltip" title="@Messages("btnUpdate.org")" class="btn btn-light" onclick="setEventOrg('@event.getId', '@event.getOrganization')" data-bs-toggle="modal" data-bs-target="#setEventOrg">
                                                <i class="bx bx-group me-0"></i>
                                            </button>
                                            @if(!event.isStatus){
                                                <button rel="tooltip" title="@Messages("btnActiveEvent")" class="btn btn-light" onclick="activeEvent('@event.getId')">
                                                    <i class="bx bx-arrow-from-bottom me-0"></i>
                                                </button>
                                            }else{
                                                <button rel="tooltip" title="@Messages("btnDeActiveEvent")" class="btn btn-light" onclick="deActiveEvent('@event.getId')">
                                                    <i class="bx bx-arrow-from-top me-0"></i>
                                                </button>
                                            }
                                            <button rel="tooltip" title="@Messages("btnDelete")" class="btn btn-light" onclick="deleteEvent('@event.getId')" data-bs-toggle="modal" data-bs-target="#deleteEventConfirm">
                                                <i class="bx bx-x me-0"></i>
                                            </button>

                                        </td>

                                    </tr>
                                }
                                </tbody>
                            </table>

                        </div>
                    </div>
                </div>
            </div>

            @views.html.events.Event_add(deviceList)
            @views.html.events.Event_del()
            @views.html.events.Event_Org(organizationList)
            @views.html.user.UserList_link()
            @views.html.events.Event_edit(deviceList)

            @views.html.Loading()
        </div>
            <!--  END OF PAPER WRAP -->


    </body>

    @views.html.iot.tags.Main_js()

    <script src="@routes.Assets.versioned("assets/js/bootstrap.bundle.min.js")"></script>
        <!--plugins-->
    <script src="@routes.Assets.versioned("assets/plugins/simplebar/js/simplebar.min.js")"></script>
    <script src="@routes.Assets.versioned("assets/plugins/metismenu/js/metisMenu.min.js")"></script>
    <script src="@routes.Assets.versioned("assets/plugins/perfect-scrollbar/js/perfect-scrollbar.js")"></script>
    <script>
                $(document).ready(function () {
                    $("#menu-event").addClass("mm-active");
                    $("#menu").metisMenu();
                })
    </script>

    <script src="@routes.Assets.versioned("javascripts/SearchJs.js")" type="text/javascript"></script>

    <script>
                $(document).ready(function() {
                    var table = $('#dataTables').DataTable( {
                        responsive: true,
                        lengthChange: false,
//                        buttons: [ 'excel', 'pdf', 'print']
                        "order": [],
                        "info": false
                    } );
                    $("#dataTables_filter input")[0].maxLength = 30;

//                    table.buttons().container()
//                            .appendTo( '#dataTables_wrapper .col-md-6:eq(0)' );
                } );
    </script>

    <script src="@routes.Assets.versioned("javascripts/views/user/User.js")" type="text/javascript"></script>
    <script src="@routes.Assets.versioned("javascripts/views/events/events.js")" type="text/javascript"></script>

</html>
